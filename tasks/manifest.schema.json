{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://cryptoreference.io/tasks/manifest.schema.json",
  "title": "CR Task Manifest Schema",
  "description": "Schema for daily AI task manifest - deterministic batch generation",
  "type": "object",
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference"
    },
    "generated_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of manifest generation"
    },
    "registry_version": {
      "type": "string",
      "description": "Version of registry used for generation"
    },
    "total_tasks": {
      "type": "integer",
      "minimum": 0,
      "description": "Total number of tasks in manifest"
    },
    "tasks": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Task"
      },
      "description": "Array of tasks to execute"
    }
  },
  "required": ["generated_at", "registry_version", "total_tasks", "tasks"],
  "additionalProperties": false,
  "definitions": {
    "Task": {
      "type": "object",
      "properties": {
        "registry_id": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "Registry ID for this task"
        },
        "page_type": {
          "type": "string",
          "enum": ["entity", "child_entity", "education", "comparison", "interface", "metrics"],
          "description": "Type of page to generate"
        },
        "generator_type": {
          "type": "string",
          "enum": [
            "entity_generator",
            "child_entity_generator",
            "education_generator",
            "comparison_generator",
            "interface_generator",
            "metrics_generator"
          ],
          "description": "Generator to use for this task"
        },
        "source_scope": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["official_site", "official_docs", "product_pages", "campaigns", "analytics", "official_social"]
          },
          "description": "Allowed sources for fact extraction"
        },
        "priority": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "description": "Task priority (1-10, higher = more important)"
        },
        "parent_id": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "Parent entity ID (for child_entity type)"
        },
        "entities": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^[a-z][a-z0-9-]*$"
          },
          "minItems": 2,
          "description": "Entity IDs to compare (for comparison type)"
        },
        "cr_required": {
          "type": "boolean",
          "description": "Whether CR-Markup is required for this page"
        }
      },
      "required": ["registry_id", "page_type", "generator_type", "source_scope", "priority", "cr_required"],
      "additionalProperties": false
    }
  }
}
